<html lang="en"><head><style>
	:where(spicy-sections > [affordance*="collapse"])::before { 
		content: ' ';
		display: inline-block;
		width: 0.5em;
		height: 0.75em;
		margin: 0 0.4em 0 0;
		transform: rotate(90deg);
		background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='10px' height='10px' viewBox='0 0 270 240' enable-background='new 0 0 270 240' xml:space='preserve'%3e%3cpolygon fill='black' points='5,235 135,10 265,235 '/%3e%3c/svg%3e ");
		background-size: 100% 100%;
	} 

	:where(spicy-sections > .hide) {
		display: none !important;
	} 

	:where(spicy-sections > [affordance*="collapse"][aria-expanded="true"])::before, 
	:where(spicy-sections > [affordance*="collapse"][aria-expanded="true"])::after {
		transform: rotate(180deg);
	}
	</style><style type="text/css">.turbo-progress-bar {
  position: fixed;
  display: block;
  top: 0;
  left: 0;
  height: 3px;
  background: #0076ff;
  z-index: 2147483647;
  transition:
    width 300ms ease-out,
    opacity 150ms 150ms ease-in;
  transform: translate3d(0, 0, 0);
}
</style><meta name="description" content="Comprehensive vulnerability database for your open source projects and dependencies."><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/png" href="/static/img/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/static/img/favicon-16x16.png" sizes="16x16"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/blog/index.xml"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons&amp;display=block" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Overpass+Mono:wght@400;700&amp;family=Overpass:ital,wght@0,400;0,700;1,400&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons&display=block"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Overpass+Mono:wght@400;700&family=Overpass:ital,wght@0,400;0,700;1,400&display=swap"></noscript><meta charset="utf-8"><title id="title">
    GHSA-mw39-9qc2-f7mg - OSV
  </title><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZXG9G6HTBR"></script><script>window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-ZXG9G6HTBR', { 'anonymize_ip': true });</script>
<link rel="preload" fetchpriority="high" as="image" href="/static/img/external-link.svg" type="image/webp">
<script defer="defer" src="/static/vendors.54e4efa29be394fd758c.js"></script><script defer="defer" src="/static/main.9d9d626f0315d2de66ee.js"></script><link href="/static/main.258d0f8f48cf5147d916.css" rel="stylesheet"></head><body><div class="wrapper "><header class="top-bar" style="display: none;"><div class="logo"><a href="/" aria-label="Home page"><img alt="OSV logo" src="/static/img/logo.png" srcset="/static/img/logo.png, /static/img/logo@2x.png 2x" width="54" height="20"></a></div><input type="checkbox" id="hamburger-checkbox" aria-label="Hamburger Menu"> <label class="hamburger" for="hamburger-checkbox"><span></span> <span></span> <span></span></label><ul class="tabs"><li class="active page-link"><a href="/list">Vulnerability Database</a></li><li class=" page-link"><a href="/blog/">Blog</a></li><li class=" page-link external-link"><a href="https://google.github.io/osv.dev/faq/" target="”_blank”">FAQ</a></li><li class=" page-link external-link"><a href="https://google.github.io/osv.dev/" target="”_blank”">Docs</a></li><ul class="push social-icons"><li class="search-container-nav"><div class="search-toggle-container"><form class="search-form search-suggestions-container" action="/list" data-search-initialized="true"><input name="q" class="search-input" placeholder="Search vulnerabilities..." maxlength="300" autocomplete="off"> <button type="submit" class="search-submit" aria-label="Search"><span class="material-icons">arrow_forward</span></button></form><button class="search-toggle" aria-label="Toggle search" aria-expanded="false" data-search-initialized="true"><span class="material-icons">search</span></button></div></li><li><a class="logo-img" href="https://github.com/google/osv.dev" target="_blank" aria-label="Go to our github page"><img class="logo-link" src="/static/img/github-mark-white.svg" alt="Github Logo" width="24" height="24"></a></li></ul></ul></header> <div class="vulnerability-page">
  <div class="mdc-layout-grid">
    <div class="mdc-layout-grid__inner">
      <div class="mdc-layout-grid__cell--span-12 vulnerability-title">
        <h1 class="title">
          GHSA-mw39-9qc2-f7mg
        </h1>
        <a class="vulnerability-improvement-link" href="https://github.com/advisories/GHSA-mw39-9qc2-f7mg/improve">
            Suggest an improvement
          </a>
        </div>
      <div class="mdc-layout-grid__cell--span-12">
        <dl class="vulnerability-details"><dt>Source</dt>
          <dd><a href="https://github.com/advisories/GHSA-mw39-9qc2-f7mg" target="_blank" rel="noopener noreferrer">https://github.com/advisories/GHSA-mw39-9qc2-f7mg</a>
          </dd><dt>Import Source</dt>
          <dd><a href="https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-mw39-9qc2-f7mg/GHSA-mw39-9qc2-f7mg.json" target="_blank" rel="noopener noreferrer">https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-mw39-9qc2-f7mg/GHSA-mw39-9qc2-f7mg.json</a></dd>

          <dt>JSON Data</dt>
          <dd><a href="https://api.osv.dev/v1/vulns/GHSA-mw39-9qc2-f7mg" target="_blank" rel="noopener noreferrer">
            https://api.osv.dev/v1/vulns/GHSA-mw39-9qc2-f7mg</a>
          </dd>
          <dt>Aliases</dt>
          <dd>
            <ul class="aliases">
              <li>
                CVE-2024-58269
                </li>
              </ul>
          </dd>
          <dt>Published</dt>
          <dd>2025-10-24T15:27:13Z</dd>
          <dt>Modified</dt>
          <dd>2025-10-24T15:57:52.783943Z</dd><dt>Severity</dt>
          <dd>
            <ul class="severity">
              <li>
                
                  <span class="severity-level severity-medium">4.3 (Medium)</span>
                  CVSS_V3 - CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
                  <a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N" target="_blank" rel="noopener noreferrer">
                    CVSS Calculator</a>
                
              </li>
              </ul>
          </dd><dt class="summary">Summary</dt>
          <dd class="summary ">
            
            Rancher exposes sensitive information through audit logs
            
          </dd>
          <dt>Details</dt>
          <dd class="details">
            <h3>Impact</h3>

<p><strong>Note: The exploitation of this issue requires that the malicious user have access to Rancher’s audit log storage.</strong></p>

<p>A vulnerability has been identified in Rancher Manager, where sensitive information, including secret data, cluster import URLs, and registration tokens, is exposed to any entity with access to Rancher audit logs. This happens in two different ways:</p>

<ol>
<li>Secret Annotation Leakage: When creating Kubernetes Secrets using the <code>stringData</code> field, the cleartext value is embedded in the <code>kubectl.kubernetes.io/last-applied-configuration</code> annotation. This annotation is included in Rancher audit logs within both the request and response bodies, exposing secret material that should be redacted.</li>
<li>Cluster Registration Token Leakage: During the import or creation of downstream clusters (Custom, Imported, or Harvester), Rancher audit logs record full cluster registration manifests and tokens, including:
a. Non-expiring import URLs such as <code>/v3/import/&lt;token&gt;_c-m-xxxx.yaml</code>.
b. Full <code>kubectl apply</code> and <code>curl</code> commands containing registration tokens and CA checksums.
c. Token values associated with cluster registration resources (<code>clusterRegistrationToken</code>).
d. These tokens are valid until explicitly revoked and can be used to re-register nodes, granting unauthorized cluster access.</li>
</ol>

<p>An attacker or internal user who gains access to these logs could:
- Recover plaintext secret values from annotations.
- Use cluster registration tokens or import URLs to re-enroll agents or compromise downstream clusters.
- Access clusters that rely on these tokens for authentication, enabling lateral movement.</p>

<p>Please consult the associated  <a href="https://attack.mitre.org/techniques/T1654/">MITRE ATT&amp;CK - Technique - Log Enumeration</a> for further information about this category of attack.</p>

<h3>Patches</h3>

<p>This vulnerability is addressed by applying redaction to sensitive information that was leaking.</p>

<p>Patched versions of Rancher include release <code>v2.12.3</code>.</p>

<h3>Workarounds</h3>

<p>If the deployment can't be upgraded to a fixed version, users are encouraged to create <code>AuditPolicies</code> to redact and filter some of those requests as described in our <a href="https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-api-audit-log#audit-log-policies">documentation</a>.</p>

<p>Also consider granting access to Rancher's logs only for trusted users.</p>

<h3>References</h3>

<p>If you have any questions or comments about this advisory:
- Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.
- Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.
- Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</p>
</dd>
          <dt>
            Database specific
            <a href="https://ossf.github.io/osv-schema/#database_specific-field" target="_blank" rel="noopener noreferrer"></a>
          </dt>
          <dd><pre class="specific">{
    "github_reviewed_at": "2025-10-24T15:27:13Z",
    "github_reviewed": true,
    "severity": "MODERATE",
    "nvd_published_at": null,
    "cwe_ids": [
        "CWE-532"
    ]
}</pre></dd>
          
          <dt>References</dt>
          <dd>
            <ul class="links">
              <li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-mw39-9qc2-f7mg" target="_blank" rel="noopener noreferrer">https://github.com/rancher/rancher/security/advisories/GHSA-mw39-9qc2-f7mg</a></li>
              <li><a href="https://github.com/rancher/rancher/commit/26ad9216e94f77b5471f638256a6989030572adc" target="_blank" rel="noopener noreferrer">https://github.com/rancher/rancher/commit/26ad9216e94f77b5471f638256a6989030572adc</a></li>
              <li><a href="https://github.com/rancher/rancher/commit/50dc516a19ea216e270f738912dc8d0c9ca99d5d" target="_blank" rel="noopener noreferrer">https://github.com/rancher/rancher/commit/50dc516a19ea216e270f738912dc8d0c9ca99d5d</a></li>
              <li><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer">https://github.com/rancher/rancher</a></li>
              </ul>
          </dd>
          
        </dl>
      </div>
    </div>
  </div>
  <div class="vulnerability-packages-container">
  <h2 class="title">Affected packages</h2>

  
    <spicy-sections class="vulnerability-packages" mq-matched="tab-bar" affordance="tab-bar">
      
      
      
      
      <h2 class="package-header" slot="tabListSlot" role="tab" aria-controls="cp1" aria-selected="true" tabindex="0" style="display: none;">
        <span class="vuln-ecosystem spicy-sections-workaround">Go</span>
        <span class="vuln-title-divider spicy-sections-workaround">/</span>
        <span class="vuln-name spicy-sections-workaround">github.com/rancher/rancher</span>
      </h2>
      <div class="mdc-layout-grid" tabindex="0" id="cp1" role="tabpanel" aria-labelledby=""><div class="vulnerability-package-subsection mdc-layout-grid__inner">
          <h3 class="mdc-layout-grid__cell--span-3">
            Package
          </h3>
          <div class="mdc-layout-grid__cell--span-9">
            <dl>
              <dt>Name</dt><dd><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer">github.com/rancher/rancher</a></dd><dd><a href="https://deps.dev/go/github.com%2Francher%2Francher" target="_blank" rel="noopener noreferrer">
                View open source insights on deps.dev</a></dd><dt>Purl</dt>
              <dd class="purl">pkg:golang/github.com/rancher/rancher</dd></dl>
          </div>
        </div><div class="vulnerability-package-subsection mdc-layout-grid__inner">
          <h3 class="mdc-layout-grid__cell--span-3">
            Affected ranges
            <a href="https://ossf.github.io/osv-schema/#examples" target="_blank" rel="noopener noreferrer"></a>
          </h3>
          <div class="mdc-layout-grid__cell--span-9">
          <dl>
              <dt>Type</dt>
              <dd>SEMVER</dd><dt>Events</dt>
              <dd>
                <div class="mdc-layout-grid__inner events">
                  <div class="mdc-layout-grid__cell--span-3">
                      Introduced</div>
                    <div class="mdc-layout-grid__cell--span-9 version-value">
                      <div class="tooltip">
                          0<span class="tooltiptext">Unknown introduced version / All previous versions are affected</span>
                          </div>
                      </div>
                  <div class="mdc-layout-grid__cell--span-3">
                      Fixed</div>
                    <div class="mdc-layout-grid__cell--span-9 version-value">
                      0.0.0-20251013203444-50dc516a19ea</div>
                  </div>
              </dd></dl>
          </div>
        </div>
        </div>
      </spicy-sections>
  
</div>
</div>


<script>
  document.addEventListener('turbo:load', function() {
    const ECOSYSTEM_EXPAND_THRESHOLD = 10;
    const PACKAGE_EXPAND_THRESHOLD = 7;
    const ECOSYSTEM_PACKAGE_COLLAPSE_THRESHOLD = 9;

  /**
   * Sets up the vertical, grouped layout for vulnerability packages.
   * - All ecosystem headers are expanded if their total count is below `ECOSYSTEM_EXPAND_THRESHOLD`,
   *   and if their total packages count is below `ECOSYSTEM_PACKAGE_COLLAPSE_THRESHOLD`.
   * - Within each ecosystem, all package headers are expanded if their count is below `PACKAGE_EXPAND_THRESHOLD`.
   */
    function setupVerticalLayout() {
      const ecosystemHeaders = document.querySelectorAll('.vulnerability-packages.force-collapse .package-header');
      if (!ecosystemHeaders.length) return;

      const shouldExpandEcosystems = ecosystemHeaders.length < ECOSYSTEM_EXPAND_THRESHOLD;

      ecosystemHeaders.forEach(header => {
        const panel = header.nextElementSibling;
        const packageHeaders = panel ? panel.querySelectorAll('.package-name-title') : [];
        const hasManyPackages =
          ecosystemHeaders.length > 1 && packageHeaders.length > ECOSYSTEM_PACKAGE_COLLAPSE_THRESHOLD;

        const shouldExpandHeader =
          shouldExpandEcosystems &&
          header.getAttribute('aria-expanded') === 'false' &&
          panel !== null &&
          !hasManyPackages;

        if (shouldExpandHeader) {
          header.click();
        }
      });

      const ecosystemPanels = document.querySelectorAll('.ecosystem-content-panel');
      ecosystemPanels.forEach(panel => {
        const packageHeaders = panel.querySelectorAll('.package-name-title');
        if (packageHeaders.length <= PACKAGE_EXPAND_THRESHOLD) {
          packageHeaders.forEach(header => {
            if (header.getAttribute('aria-expanded') === 'false') {
              header.click();
            }
          });
        }
      });
    }
    
    /**
     * Sets up the default layout,(tabs on desktop, accordion on mobile).
     * This function ensures that on the mobile accordion view,
     * all package headers are expanded by default if their count is
     * below a defined threshold. This has no effect on the desktop tab view.
     */
    function setupDefaultLayout() {
      const packageHeaders = document.querySelectorAll('.vulnerability-packages:not(.force-collapse) .package-header');
      if (!packageHeaders.length) return;

     /**
     * Expands collapsed package headers.
     * We use `spicy-section` to make the packages content collapsible for mobile view,
     * but it collapses the content by default. We want it expanded after the page
     * is loaded, so we programmatically click on the header of collapsed packages
     * to make the content visible.
     */
      function expandPackageHeaders() {
        packageHeaders.forEach((header) => {
          if (header.getAttribute('aria-expanded') === 'false') {
            header.click();
          }
        });
      }

      if (packageHeaders.length < ECOSYSTEM_EXPAND_THRESHOLD) {
        expandPackageHeaders();
      }
    }

    if (document.querySelector('.vulnerability-packages.force-collapse')) {
      setupVerticalLayout();
    } else {
      setupDefaultLayout();
    }

    /**
     * Sets up "Show More" / "Show Less" functionality for lists that might have
     * many items. You can enable this feature by adding an 'expandible-list' or
     * 'expandible-hierarchy-list' class to lists with long value.
     * @param {string} listSelector The CSS selector for the list container.
     * @param {string} itemSelector The tag name of the items within the list.
     */
    function setupExpandibleList(listSelector, itemSelector) {
      const EXPANDIBLE_LIST_DEFAULT_LENGTH = 6;
      const lists = document.querySelectorAll(`${listSelector}:not(.expanded):not([data-has-toggle-btn])`);
      lists.forEach((list) => {
        const items = list.getElementsByTagName(itemSelector);
        if (items.length <= EXPANDIBLE_LIST_DEFAULT_LENGTH) return;

        const expandibleItems = [...items].slice(EXPANDIBLE_LIST_DEFAULT_LENGTH);
        expandibleItems.forEach((item) => {
          item.style.display = 'none';
        });

        const toggleButton = document.createElement('span');
        toggleButton.classList.add('showmore');
        toggleButton.textContent = 'Show More';
        list.append(toggleButton);
        list.setAttribute('data-has-toggle-btn', 'true');

        toggleButton.addEventListener('click', function() {
          const isExpanded = list.classList.contains('expanded');
          expandibleItems.forEach((item) => {
            item.style.display = isExpanded ? 'none' : 'block';
          });
          toggleButton.textContent = isExpanded ? 'Show More' : 'Show Less';
          list.classList.toggle('expanded');
        });
      });
    }

    setupExpandibleList('.expandible-hierarchy-list', 'ul');
    setupExpandibleList('.expandible-list', 'li');
  });
</script>
</div></body></html>